/*
 * jquery.socialshareprivacy.js | 2 Klicks fuer mehr Datenschutz
 *
 * http://www.heise.de/extras/socialshareprivacy/
 * http://www.heise.de/ct/artikel/2-Klicks-fuer-mehr-Datenschutz-1333879.html
 *
 * Copyright (c) 2011 Hilko Holweg, Sebastian Hilbig, Nicolas Heiringhoff, Juergen Schmidt,
 * Heise Zeitschriften Verlag GmbH & Co. KG, http://www.heise.de
 *
 * is released under the MIT License http://www.opensource.org/licenses/mit-license.php
 *
 * Spread the word, link to us if you can.
 */
(function(e){"use strict";function t(e,t){var n=decodeURIComponent(e);if(n.length<=t){return e}var r=n.substring(0,t-1).lastIndexOf(" ");n=encodeURIComponent(n.substring(0,r))+"…";return n}function n(t){var n=e('meta[name="'+t+'"]').attr("content");return n||""}function r(){var t=n("DC.title");var r=n("DC.creator");if(t.length>0&&r.length>0){t+=" - "+r}else{t=e("title").text()}return encodeURIComponent(t)}function i(){var t=document.location.href;var n=e("link[rel=canonical]").attr("href");if(n&&n.length>0){if(n.indexOf("http")<0){n=document.location.protocol+"//"+document.location.host+n}t=n}return t}e.fn.socialSharePrivacy=function(n){var s={services:{facebook:{status:"on",dummy_img:"img/privacy/dummy_facebook.png",display_name:"Facebook",language:"de_DE",action:"recommend"},twitter:{status:"on",dummy_img:"img/privacy/dummy_twitter.png",display_name:"Twitter",tweet_text:r,language:"en"},gplus:{status:"on",dummy_img:"img/privacy/dummy_gplus.png",display_name:"Google+",language:"de"}},cookie_path:"/",cookie_domain:document.location.host,cookie_expires:"365",css_path:"css/privacy.css",uri:i};var o=e.extend(true,s,n);var u=o.services.facebook.status==="on";var a=o.services.twitter.status==="on";var f=o.services.gplus.status==="on";if(!u&&!a&&!f){return}if(o.css_path.length>0){if(document.createStyleSheet){document.createStyleSheet(o.css_path)}else{e("head").append('<link rel="stylesheet" type="text/css" href="'+o.css_path+'" />')}}return this.each(function(){e(this).prepend('<ul class="social_share_privacy_area"></ul>');var n=e(".social_share_privacy_area",this);var r=o.uri;if(typeof r==="function"){r=r(n)}if(u){var i=encodeURIComponent(r);var s='<iframe src="http://www.facebook.com/plugins/like.php?locale='+o.services.facebook.language+"&href="+i+"&send=false&layout=button_count&width=120&show_faces=false&action="+o.services.facebook.action+'&colorscheme=light&font&height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:145px; height:21px;" allowTransparency="true"></iframe>';var l='<img src="'+o.services.facebook.dummy_img+'" alt="Facebook "Like"-Dummy" class="fb_like_privacy_dummy" />';n.append('<li class="facebook"><span class="switch off"></span><div class="fb_like dummy_btn">'+l+"</div></li>");var c=e("li.facebook",n);n.on("click","li.facebook div.fb_like img.fb_like_privacy_dummy,li.facebook span.switch",function(){if(c.find("span.switch").hasClass("off")){c.addClass("info_off");c.find("span.switch").addClass("on").removeClass("off");c.find("img.fb_like_privacy_dummy").replaceWith(s)}else{c.removeClass("info_off");c.find("span.switch").addClass("off").removeClass("on");c.find(".fb_like").html(l)}})}if(a){var h=o.services.twitter.tweet_text;if(typeof h==="function"){h=h()}h=t(h,"120");var p=encodeURIComponent(r);var d=encodeURIComponent(r);var v='<iframe allowtransparency="true" frameborder="0" scrolling="no" src="http://platform.twitter.com/widgets/tweet_button.html?url='+p+"&counturl="+d+"&text="+h+"&count=horizontal&lang="+o.services.twitter.language+'" style="width:130px; height:25px;"></iframe>';var m='<img src="'+o.services.twitter.dummy_img+'" alt=""Tweet this"-Dummy" class="tweet_this_dummy" />';n.append('<li class="twitter"><span class="switch off"></span><div class="tweet dummy_btn">'+m+"</div></li>");var g=e("li.twitter",n);n.on("click","li.twitter div.tweet img,li.twitter span.switch",function(){if(g.find("span.switch").hasClass("off")){g.addClass("info_off");g.find("span.switch").addClass("on").removeClass("off");g.find("img.tweet_this_dummy").replaceWith(v)}else{g.removeClass("info_off");g.find("span.switch").addClass("off").removeClass("on");g.find(".tweet").html(m)}})}if(f){var y=r;var b='<div class="g-plusone" data-size="medium" data-href="'+y+'"></div><script type="text/javascript">window.___gcfg = {lang: "'+o.services.gplus.language+'"}; (function() { var po = document.createElement("script"); po.type = "text/javascript"; po.async = true; po.src = "https://apis.google.com/js/plusone.js"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(po, s); })(); </script>';var w='<img src="'+o.services.gplus.dummy_img+'" alt=""Google+1"-Dummy" class="gplus_one_dummy" />';n.append('<li class="gplus"><span class="switch off"></span><div class="gplusone dummy_btn">'+w+"</div></li>");var E=e("li.gplus",n);n.on("click","li.gplus div.gplusone img,li.gplus span.switch",function(){if(E.find("span.switch").hasClass("off")){E.addClass("info_off");E.find("span.switch").addClass("on").removeClass("off");E.find("img.gplus_one_dummy").replaceWith(b)}else{E.removeClass("info_off");E.find("span.switch").addClass("off").removeClass("on");E.find(".gplusone").html(w)}})}})}})(jQuery)